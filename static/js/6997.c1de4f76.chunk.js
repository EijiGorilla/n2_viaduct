"use strict";(self.webpackChunkn2_viaduct=self.webpackChunkn2_viaduct||[]).push([[6997,5739],{44041:(e,t,i)=>{i.d(t,{R:()=>d});var n=i(27366),r=i(7138),l=i(76672),s=i(49861),a=(i(93169),i(32718),i(84936),i(69912)),o=i(82582),u=i(87072),m=i(58132);const y={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let d=class extends r.Z{constructor(e){super(e),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map((e=>{const t=(0,u.f)(this.floors,e);return e.toExportImageJSON(t)}));return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&(0,m.FN)(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(e){this._get("layer")!==e&&(this._set("layer",e),this.removeHandles("layer"),e&&this.addHandles([e.allSublayers.on("change",(()=>this.notifyChange("visibleSublayers"))),e.on("sublayer-update",(e=>this.notifyChange(y[e.propertyName])))],"layer"))}get layers(){const e=this.visibleSublayers;return e?e.length?"show:"+e.map((e=>e.id)).join(","):"show:-1":null}get layerDefs(){var e;const t=!(null===(e=this.floors)||void 0===e||!e.length),i=this.visibleSublayers.filter((e=>null!=e.definitionExpression||t&&null!=e.floorInfo));return i.length?JSON.stringify(i.reduce(((e,t)=>{const i=(0,u.f)(this.floors,t),n=(0,l._)(i,t.definitionExpression);return null!=n&&(e[t.id]=n),e}),{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers");const e=this.layer;return e&&(e.commitProperty("dpi"),e.commitProperty("imageFormat"),e.commitProperty("imageTransparency"),e.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const e=[];if(!this.layer)return e;const t=this.layer.sublayers,i=this.scale,n=t=>{t.visible&&(0===i||(0,o.o2)(i,t.minScale,t.maxScale))&&(t.sublayers?t.sublayers.forEach(n):e.unshift(t))};t&&t.forEach(n);const r=this._get("visibleSublayers");return!r||r.length!==e.length||r.some(((t,i)=>e[i]!==t))?e:r}toJSON(){const e=this.layer;let t={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?t.dynamicLayers=this.dynamicLayers:t={...t,layers:this.layers,layerDefs:this.layerDefs},t}};(0,n._)([(0,s.Cb)({readOnly:!0})],d.prototype,"dynamicLayers",null),(0,n._)([(0,s.Cb)()],d.prototype,"floors",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],d.prototype,"hasDynamicLayers",null),(0,n._)([(0,s.Cb)()],d.prototype,"layer",null),(0,n._)([(0,s.Cb)({readOnly:!0})],d.prototype,"layers",null),(0,n._)([(0,s.Cb)({readOnly:!0})],d.prototype,"layerDefs",null),(0,n._)([(0,s.Cb)({type:Number})],d.prototype,"scale",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],d.prototype,"version",null),(0,n._)([(0,s.Cb)({readOnly:!0})],d.prototype,"visibleSublayers",null),d=(0,n._)([(0,a.j)("esri.layers.support.ExportImageParameters")],d)},50863:(e,t,i)=>{i.d(t,{h:()=>r});var n=i(45739);function r(e,t,i){if(null==(null===e||void 0===e?void 0:e.timeInfo))return null;const{datesInUnknownTimezone:r=!1,timeOffset:l,useViewTime:s}=e;let a=e.timeExtent;r&&(a=(0,n.Jb)(a));let o=s?t&&a?t.intersection(a):t||a:a;return!o||o.isEmpty||o.isAllTime?o:(l&&(o=o.offset(-l.value,l.unit)),r&&(o=(0,n.b3)(o)),o.equals(i)?i:o)}},45739:(e,t,i)=>{i.d(t,{getTimeSliderSettingsFromWebDocument:()=>c,Jb:()=>h,b3:()=>p});var n=i(62044),r=i(63780),l=(i(44927),i(84652)),s=(i(32718),i(86710)),a=i(38675),o=i(83217);function u(e){return void 0!==e.timeInfo}async function m(e,t){var i,l;return null!==(i=null===(l=e.widgets)||void 0===l||null===(l=l.timeSlider)||void 0===l?void 0:l.fullTimeExtent)&&void 0!==i?i:async function(e,t){if(0===e.length)return n.Z.allTime;await Promise.all(e.map((e=>e.load({signal:t}))));const i=e.filter(u),l=e.filter((e=>!u(e)&&null!=e.visibilityTimeExtent));if(0===i.length&&0===l.length)return n.Z.allTime;const s=[],a=[];for(const n of i){var o;"feature"!==(null===n||void 0===n?void 0:n.type)&&"map-image"!==(null===n||void 0===n?void 0:n.type)||null===(o=n.timeInfo)||void 0===o||!o.hasLiveData?a.push(n):s.push(n)}const m=e=>null==e||e.isAllTime,y=[...a.map((e=>{var t,i;const n=null===(t=e.timeInfo)||void 0===t?void 0:t.fullTimeExtent,{visibilityTimeExtent:r}=e;return null!==(i=null===n||void 0===n?void 0:n.intersection(r))&&void 0!==i?i:r})),...l.map((e=>e.visibilityTimeExtent))];if(y.some(m))return n.Z.allTime;const d=s.map((async e=>{var i,n,r,l;const s=null!==(i=null===(n=await e.fetchRecomputedExtents({signal:t}))||void 0===n?void 0:n.timeExtent)&&void 0!==i?i:null===(r=e.timeInfo)||void 0===r?void 0:r.fullTimeExtent,{visibilityTimeExtent:a}=e;return null!==(l=null===s||void 0===s?void 0:s.intersection(a))&&void 0!==l?l:a})),c=(await Promise.allSettled(d)).map((e=>"fulfilled"===e.status?e.value:null));if(c.some(m))return n.Z.allTime;const p=[...c,...y].filter(r.pC);return 0===p.length?n.Z.allTime:p.reduce(((e,t)=>e.union(t)))}(e.allLayers,t)}function y(e){const{numStops:t,stopInterval:i,stops:n}=e;return n?{dates:(0,l.d9)(n)}:i?{interval:i.clone()}:{count:null!==t&&void 0!==t?t:5}}function d(e,t){var i;const r=e.currentTimeExtent;if(!r)return null;const{start:l,end:s}=r,a=null!==(i=null!==l&&void 0!==l?l:s)&&void 0!==i?i:null;switch(t){case"time-window":return new n.Z({start:l,end:s});case"cumulative-from-start":return new n.Z({start:null,end:a});case"cumulative-from-end":return new n.Z({start:a,end:null});case"instant":return new n.Z({start:a,end:a})}}async function c(e,t){var i,n;if(!(0,a.s)(e)&&!function(e){return null!=e&&"object"==typeof e&&o.x in e}(e))return null;await e.load({signal:t});const r=null===e||void 0===e||null===(i=e.widgets)||void 0===i?void 0:i.timeSlider;if(!r)return null;const l=await m(e,t),s=r.loop,u=function(e){var t;const i=null!==(t=e.numThumbs)&&void 0!==t?t:2,n=e.currentTimeExtent;if(n){const{start:e,end:t}=n;return null!=e&&null!=t&&e.getTime()===t.getTime()?"instant":2===i?"time-window":null==e||0===e.getTime()?"cumulative-from-start":"cumulative-from-end"}return 2===i?"time-window":"cumulative-from-start"}(r);return{fullTimeExtent:l,loop:s,mode:u,playRate:null!==(n=r.stopDelay)&&void 0!==n?n:2e3,stops:y(r),timeExtent:d(r,u)}}function p(e){if(!e)return e;const{start:t,end:i}=e;return new n.Z({start:null!=t?(0,s.Nm)(t,-t.getTimezoneOffset(),"minutes"):t,end:null!=i?(0,s.Nm)(i,-i.getTimezoneOffset(),"minutes"):i})}function h(e){if(!e)return e;const{start:t,end:i}=e;return new n.Z({start:null!=t?(0,s.Nm)(t,t.getTimezoneOffset(),"minutes"):t,end:null!=i?(0,s.Nm)(i,i.getTimezoneOffset(),"minutes"):i})}},46997:(e,t,i)=>{i.r(t),i.d(t,{default:()=>c});var n=i(27366),r=(i(32718),i(93169),i(84936),i(10064),i(69912)),l=i(69229),s=i(49861),a=i(44041),o=i(50863);const u=e=>{let t=class extends e{initialize(){this.exportImageParameters=new a.R({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get floors(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.floors)&&void 0!==e?e:null}get exportImageVersion(){var e;return null!==(e=this.exportImageParameters)&&void 0!==e&&e.commitProperty("version"),this.commitProperty("timeExtent"),this.commitProperty("floors"),(this._get("exportImageVersion")||0)+1}get timeExtent(){var e;return(0,o.h)(this.layer,null===(e=this.view)||void 0===e?void 0:e.timeExtent,this._get("timeExtent"))}canResume(){var e;return!!super.canResume()&&!(null!==(e=this.timeExtent)&&void 0!==e&&e.isEmpty)}};return(0,n._)([(0,s.Cb)()],t.prototype,"exportImageParameters",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],t.prototype,"floors",null),(0,n._)([(0,s.Cb)({readOnly:!0})],t.prototype,"exportImageVersion",null),(0,n._)([(0,s.Cb)()],t.prototype,"layer",void 0),(0,n._)([(0,s.Cb)()],t.prototype,"suspended",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],t.prototype,"timeExtent",null),t=(0,n._)([(0,r.j)("esri.views.layers.MapImageLayerView")],t),t};var m=i(32645),y=i(45008);let d=class extends(u(l.Z)){constructor(){super(...arguments),this.type="map-image-3d"}initialize(){this._updatingHandles.add((()=>this.exportImageVersion),(()=>this._updatingHandles.addPromise(this.refreshDebounced()))),this._popupHighlightHelper=new m.VF({createFetchPopupFeaturesQueryGeometry:(e,t)=>(0,y.K)(e,t,this.view),layerView:this,updatingHandles:this._updatingHandles})}destroy(){var e;null===(e=this._popupHighlightHelper)||void 0===e||e.destroy()}fetchPopupFeaturesAtLocation(e,t){return this._popupHighlightHelper.fetchPopupFeaturesAtLocation(e,t)}getFetchOptions(){return{timeExtent:this.timeExtent}}};d=(0,n._)([(0,r.j)("esri.views.3d.layers.MapImageLayerView3D")],d);const c=d},38675:(e,t,i)=>{function n(e){return null!=e&&"object"==typeof e&&"declaredClass"in e&&"esri.WebMap"===e.declaredClass}i.d(t,{s:()=>n})}}]);
//# sourceMappingURL=6997.c1de4f76.chunk.js.map