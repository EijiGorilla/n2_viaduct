"use strict";(self.webpackChunkn2_viaduct=self.webpackChunkn2_viaduct||[]).push([[4495,5739],{25666:(e,t,n)=>{n.d(t,{cn:()=>i,j:()=>s,lK:()=>r});const i="updating";function r(e){return"updating"===e?null:e}function s(e){return"updating"===e}},50863:(e,t,n)=>{n.d(t,{h:()=>r});var i=n(45739);function r(e,t,n){if(null==(null===e||void 0===e?void 0:e.timeInfo))return null;const{datesInUnknownTimezone:r=!1,timeOffset:s,useViewTime:o}=e;let l=e.timeExtent;r&&(l=(0,i.Jb)(l));let a=o?t&&l?t.intersection(l):t||l:l;return!a||a.isEmpty||a.isAllTime?a:(s&&(a=a.offset(-s.value,s.unit)),r&&(a=(0,i.b3)(a)),a.equals(n)?n:a)}},45739:(e,t,n)=>{n.d(t,{getTimeSliderSettingsFromWebDocument:()=>f,Jb:()=>h,b3:()=>y});var i=n(63780),r=(n(44927),n(84652)),s=(n(32718),n(86710)),o=n(54486),l=n(3276),a=n(83217);function u(e){return void 0!==e.timeInfo}async function c(e,t){var n,r;return null!==(n=null===(r=e.widgets)||void 0===r||null===(r=r.timeSlider)||void 0===r?void 0:r.fullTimeExtent)&&void 0!==n?n:async function(e,t){if(0===e.length)return o.Z.allTime;await Promise.all(e.map((e=>e.load({signal:t}))));const n=e.filter(u),r=e.filter((e=>!u(e)&&null!=e.visibilityTimeExtent));if(0===n.length&&0===r.length)return o.Z.allTime;const s=[],l=[];for(const i of n){var a;"feature"!==(null===i||void 0===i?void 0:i.type)&&"map-image"!==(null===i||void 0===i?void 0:i.type)||null===(a=i.timeInfo)||void 0===a||!a.hasLiveData?l.push(i):s.push(i)}const c=e=>null==e||e.isAllTime,d=[...l.map((e=>{var t,n;const i=null===(t=e.timeInfo)||void 0===t?void 0:t.fullTimeExtent,{visibilityTimeExtent:r}=e;return null!==(n=null===i||void 0===i?void 0:i.intersection(r))&&void 0!==n?n:r})),...r.map((e=>e.visibilityTimeExtent))];if(d.some(c))return o.Z.allTime;const p=s.map((async e=>{var n,i,r,s;const o=null!==(n=null===(i=await e.fetchRecomputedExtents({signal:t}))||void 0===i?void 0:i.timeExtent)&&void 0!==n?n:null===(r=e.timeInfo)||void 0===r?void 0:r.fullTimeExtent,{visibilityTimeExtent:l}=e;return null!==(s=null===o||void 0===o?void 0:o.intersection(l))&&void 0!==s?s:l})),f=(await Promise.allSettled(p)).map((e=>"fulfilled"===e.status?e.value:null));if(f.some(c))return o.Z.allTime;const y=[...f,...d].filter(i.pC);return 0===y.length?o.Z.allTime:y.reduce(((e,t)=>e.union(t)))}(e.allLayers,t)}function d(e){const{numStops:t,stopInterval:n,stops:i}=e;return i?{dates:(0,r.d9)(i)}:n?{interval:n.clone()}:{count:null!==t&&void 0!==t?t:5}}function p(e,t){var n;const i=e.currentTimeExtent;if(!i)return null;const{start:r,end:s}=i,l=null!==(n=null!==r&&void 0!==r?r:s)&&void 0!==n?n:null;switch(t){case"time-window":return new o.Z({start:r,end:s});case"cumulative-from-start":return new o.Z({start:null,end:l});case"cumulative-from-end":return new o.Z({start:l,end:null});case"instant":return new o.Z({start:l,end:l})}}async function f(e,t){var n,i;if(!(0,l.s)(e)&&!function(e){return null!=e&&"object"==typeof e&&a.x in e}(e))return null;await e.load({signal:t});const r=null===e||void 0===e||null===(n=e.widgets)||void 0===n?void 0:n.timeSlider;if(!r)return null;const s=await c(e,t),o=r.loop,u=function(e){var t;const n=null!==(t=e.numThumbs)&&void 0!==t?t:2,i=e.currentTimeExtent;if(i){const{start:e,end:t}=i;return null!=e&&null!=t&&e.getTime()===t.getTime()?"instant":2===n?"time-window":null==e||0===e.getTime()?"cumulative-from-start":"cumulative-from-end"}return 2===n?"time-window":"cumulative-from-start"}(r);return{fullTimeExtent:s,loop:o,mode:u,playRate:null!==(i=r.stopDelay)&&void 0!==i?i:2e3,stops:d(r),timeExtent:p(r,u)}}function y(e){if(!e)return e;const{start:t,end:n}=e;return new o.Z({start:null!=t?(0,s.Nm)(t,-t.getTimezoneOffset(),"minutes"):t,end:null!=n?(0,s.Nm)(n,-n.getTimezoneOffset(),"minutes"):n})}function h(e){if(!e)return e;const{start:t,end:n}=e;return new o.Z({start:null!=t?(0,s.Nm)(t,t.getTimezoneOffset(),"minutes"):t,end:null!=n?(0,s.Nm)(n,n.getTimezoneOffset(),"minutes"):n})}},71039:(e,t,n)=>{n.d(t,{z:()=>D});var i=n(27366),r=(n(59486),n(7138)),s=n(63780),o=n(32718),l=n(16889),a=n(25666),u=n(94172),c=n(68860),d=n(49861),p=(n(93169),n(69912)),f=n(32035),y=n(12400),h=n(89434),g=n(83448),m=n(79803),v=n(51066),E=n(5986),w=n(41414),b=n(65156),_=n(86372),x=n(22186),S=n(92975),I=n(83479),F=n(81753),C=n(18661),T=n(44011),R=n(78952);const O="esri.views.3d.layers.i3s.I3SMeshViewFilter",j=()=>o.Z.getLogger(O);let D=class extends r.Z{constructor(e){super(e),this._projectionEngineLoaded=!1}initialize(){(0,u.N1)((()=>{var e;return(null===(e=this.viewFilter)||void 0===e?void 0:e.geometry)||null!=this.layerFilter})).then((()=>this.loadAsyncModule(Promise.all([n.e(9058),n.e(5140)]).then(n.bind(n,2170)).then((e=>{this.destroyed||(this._geometryEngine=e)})))))}get sortedObjectIds(){var e;if(null==(null===(e=this.viewFilter)||void 0===e?void 0:e.objectIds))return null;const t=(0,_.QZ)(this.viewFilter.objectIds);return t.sort(),t}get parsedWhereClause(){var e;const t=null===(e=this.viewFilter)||void 0===e?void 0:e.where;if(null==t||!t)return null;try{return h.WhereClause.create(t,{fieldsIndex:this.layerFieldsIndex})}catch(n){j().error("Failed to parse filter where clause: ".concat(n))}return null}addFilters(e,t,n,i){var r;const s=this.sortedObjectIds;null!=s&&e.push((e=>(0,T.Yb)(s,!0,e))),this.addSqlFilter(e,this.parsedWhereClause),this.addTimeFilter(e,null===(r=this.viewFilter)||void 0===r?void 0:r.timeExtent);const o=(0,a.lK)(this._layerMaskGeometries),l=this._geometryEngine;if(null!=o&&null!=this.layerFilter&&null!=l){const r=this.layerFilter.spatialRelationship;e.push(((e,s)=>M(l,e,s,i,t,n,o,r)))}const u=(0,a.lK)(this._viewMaskGeometries);if(null!=u&&null!=this.viewFilter&&null!=l){const r=this.viewFilter.spatialRelationship;e.push(((e,s)=>M(l,e,s,i,t,n,u,r)))}}isMBSGeometryVisible(e,t,n){const i=(0,a.lK)(this._layerMaskGeometries),r=this._geometryEngine;if(null!=i&&null!=this.layerFilter&&null!=r){const s=this.layerFilter.spatialRelationship,o=i[0].spatialReference||t;return(0,v.s)(e,n,A,o)?k(r,A,i,o,s):(j().warnOnce("SceneLayer.mask geometry is using unsupported SpatialReference, skipping geometry filter for MBS"),!0)}const s=(0,a.lK)(this._viewMaskGeometries);if(null!=s&&null!=this.viewFilter&&null!=r){const i=this.viewFilter.spatialRelationship,o=s[0].spatialReference||t;return(0,v.s)(e,n,A,o)?k(r,A,s,o,i):(j().warnOnce("SceneLayerView.filter.geometry is using unsupported SpatialReference, skipping geometry filter for MBS"),!0)}return!0}get parsedGeometry(){const e=(0,a.lK)(this._viewMaskGeometries),t=(0,a.lK)(this._layerMaskGeometries);return null==e||null==t?e||t:t.concat(e)}get _layerMaskGeometries(){const e=this.layerFilter;return null==e?null:null==this._geometryEngine?a.cn:"disjoint"===e.spatialRelationship?e.geometries.map((e=>({type:"polygon",rings:e.rings,spatialReference:e.spatialReference,cache:{}}))):[e.geometries.reduce(((e,t)=>(e.rings=[...e.rings,...t.rings],e)),{type:"polygon",rings:[],spatialReference:e.geometries[0].spatialReference,cache:{}})]}get _viewMaskGeometries(){if(null==this.viewFilter)return null;const{geometry:e}=this.viewFilter;if(null==e)return null;if(null==this.viewFilter||null==this._geometryEngine)return a.cn;const{distance:t,units:n}=this.viewFilter,i=this.viewFilter.spatialRelationship,r="mesh"===e.type?e.extent:e;if(null==t||0===t)return Q(this._geometryEngine,r,i);const s=n||(0,c.qE)(r.spatialReference);if(r.spatialReference.isWGS84){const e=this._geometryEngine.geodesicBuffer(r,t,s);return Q(this._geometryEngine,e,i)}const o=(0,F.iV)(r,R.Z.WGS84);if(null!=o){const e=(0,F.iV)(this._geometryEngine.geodesicBuffer(o,t,s),r.spatialReference);return Q(this._geometryEngine,e,i)}if(!this._projectionEngineLoaded&&(this.loadAsyncModule((0,m.load)().then((()=>this._projectionEngineLoaded=!0))),!this._projectionEngineLoaded))return null;let l=null;try{l=(0,m.project)(r,R.Z.WGS84)}catch(u){}if(l)try{l=(0,m.project)(this._geometryEngine.geodesicBuffer(l,t,s),r.spatialReference)}catch(u){l=null}return l||j().error("Filter by geodesic buffer (distance) unsupported, failed to project input geometry (".concat(r.spatialReference.wkid,") to WGS84.")),Q(this._geometryEngine,l,i)}get updating(){return(0,a.j)(this._layerMaskGeometries)||(0,a.j)(this._viewMaskGeometries)}static checkSupport(e){return null!=e&&(!!function(e){return null!=e&&Z.includes(e)}(e.spatialRelationship)||(j().warn("Filters with spatialRelationship other than ".concat(Z.join(", ")," are not supported for mesh scene layers")),!1))}};(0,i._)([(0,d.Cb)()],D.prototype,"layerFilter",void 0),(0,i._)([(0,d.Cb)({type:C.Z})],D.prototype,"viewFilter",void 0),(0,i._)([(0,d.Cb)()],D.prototype,"layerFieldsIndex",void 0),(0,i._)([(0,d.Cb)()],D.prototype,"loadAsyncModule",void 0),(0,i._)([(0,d.Cb)()],D.prototype,"addSqlFilter",void 0),(0,i._)([(0,d.Cb)()],D.prototype,"addTimeFilter",void 0),(0,i._)([(0,d.Cb)({readOnly:!0})],D.prototype,"sortedObjectIds",null),(0,i._)([(0,d.Cb)({readOnly:!0})],D.prototype,"parsedWhereClause",null),(0,i._)([(0,d.Cb)({readOnly:!0})],D.prototype,"parsedGeometry",null),(0,i._)([(0,d.Cb)({readOnly:!0})],D.prototype,"_layerMaskGeometries",null),(0,i._)([(0,d.Cb)({readOnly:!0})],D.prototype,"_viewMaskGeometries",null),(0,i._)([(0,d.Cb)()],D.prototype,"updating",null),(0,i._)([(0,d.Cb)()],D.prototype,"_projectionEngineLoaded",void 0),(0,i._)([(0,d.Cb)()],D.prototype,"_geometryEngine",void 0),D=(0,i._)([(0,p.j)(O)],D);const Z=["contains","intersects","disjoint"];var N;function Q(e,t,n){if(null==t)return null;if("disjoint"===n&&"polygon"===t.type){const n=t.rings.length,i=t.spatialReference,r=new Array(n);for(let e=0;e<n;++e){const n=(0,b.al)(1/0,1/0,-1/0,-1/0);(0,b.Wi)(n,t.rings[e]),r[e]={type:"polygon",rings:[t.rings[e]],spatialReference:i,cache:{},aabr:n}}r.sort(((e,t)=>e.aabr[0]-t.aabr[0]));const o=new Set,l=new s.SO;for(let t=0;t<r.length;++t){const n=r[t],i=n.aabr[0];o.forEach((t=>{if(i>=t.aabr[2])return void o.delete(t);if(n.aabr[1]>t.aabr[3]||n.aabr[3]<t.aabr[1]||!e.intersects(n,t))return;n.rings=n.rings.concat(t.rings),(0,b.jn)(n.aabr,t.aabr,n.aabr),n.cache={},o.delete(t);const a=(0,s.cq)(r,t,r.length,l);r.splice(a,1)})),o.add(n)}for(const e of r)e.aabr=void 0;return r}return[t]}function k(e,t,n,i,r){if(t[3]>=.5*(t[2]+(0,g.Iu)(i).radius))return!0;const s=G(e,t,i);return n.every((t=>K(e,t,s,r)!==N.DISCARD))}function M(e,t,n,i,r,s,o,l){const a=o[0].spatialReference||r.spatialReference;if(!(0,v.s)(n.node.serviceMbsInIndexSR,s,A,a))return void j().warnOnce("SceneLayerView.filter.geometry is using unsupported SpatialReference, skipping geometry filter");const u=G(e,A,a),c=function(e,t,n,i,r){const s=t.renderSpatialReference,o=new Map,l={type:"polygon",rings:[[[0,0,0],[0,0,0],[0,0,0],[0,0,0]]],spatialReference:n};l.rings[0][3]=l.rings[0][0];const a={indices:null,data:null,stride:0,startIndex:0,endIndex:0};let u,c;switch(e){case"intersects":u=(e,t,n)=>e.intersects(t,n)?N.KEEP:N.TEST,c=J;break;case"contains":u=(e,t,n)=>e.contains(t,n)?N.TEST:N.DISCARD,c=J;break;default:u=(e,t,n)=>e.disjoint(t,n)?N.TEST:N.DISCARD,c=L}return{collection:i,object:r,type:e,maskSR:n,renderSR:s,aabbCache:o,triangle:l,positions:a,triangleTest:u,geometryTest:c}}(l,r,a,i,n.objectHandle);for(const d of o){if(0===t.length)return;switch(K(e,d,u,l)){case N.DISCARD:return void(t.length=0);case N.KEEP:continue}(0,T.hv)(t,n.featureIds,(t=>q(e,d,t,c)))}}!function(e){e[e.KEEP=0]="KEEP",e[e.DISCARD=1]="DISCARD",e[e.TEST=2]="TEST"}(N||(N={}));const A=(0,I.f)(0,0,0,0);function G(e,t,n){const i={type:"point",x:t[0],y:t[1],hasZ:!1,hasM:!1,spatialReference:n},r=!(0,S.oR)(n)&&!(0,S.sS)(n),s=Number.isNaN(t[3])?0:(0,l.uZ)(t[3],0,2*x.sv.radius),o=r?e.buffer(i,s,1):e.geodesicBuffer(i,s,1);return o.type="polygon",o}function K(e,t,n,i){switch(i){case"intersects":case"contains":return J(e,t,n);case"disjoint":return L(e,t,n)}}function J(e,t,n){return e.intersects(t,n)?e.contains(t,n)?N.KEEP:N.TEST:N.DISCARD}function L(e,t,n){return e.intersects(t,n)?e.contains(t,n)?N.DISCARD:N.TEST:N.KEEP}function q(e,t,n,i){const{collection:r,object:s,renderSR:o,maskSR:l,geometryTest:a,aabbCache:u}=i;let c=u.get(n);if(!c){const e=r.getObjectTransform(s);r.getComponentAabb(s,n,V);const t=[(0,y.al)(V[0],V[1],0),(0,y.al)(V[0],V[4],0),(0,y.al)(V[3],V[4],0),(0,y.al)(V[3],V[1],0)];for(let n=0;n<4;++n)(0,f.q)(t[n],t[n],e.rotationScale),(0,f.g)(t[n],t[n],e.position),(0,E.S)(t[n],o,t[n],l);c={type:"polygon",rings:[t],spatialReference:l,cache:{}},c.rings[0][4]=c.rings[0][0],u.set(n,c)}switch(a(e,t,c)){case N.DISCARD:return!1;case N.KEEP:return!0}const{triangle:d,triangleTest:p,positions:h}=i,g=d.rings[0][0],m=d.rings[0][1],v=d.rings[0][2],w=r.getObjectTransform(s);r.getComponentPositions(s,n,h);const{indices:b,data:_,stride:x,startIndex:S,endIndex:I}=h;for(let y=S;y<I;y+=3){const n=x*b[y],i=x*b[y+1],r=x*b[y+2];switch((0,f.i)(g,_[n],_[n+1],_[n+2]),(0,f.i)(m,_[i],_[i+1],_[i+2]),(0,f.i)(v,_[r],_[r+1],_[r+2]),(0,f.q)(g,g,w.rotationScale),(0,f.q)(m,m,w.rotationScale),(0,f.q)(v,v,w.rotationScale),(0,f.g)(g,g,w.position),(0,f.g)(m,m,w.position),(0,f.g)(v,v,w.position),(0,E.S)(g,o,g,l),(0,E.S)(m,o,m,l),(0,E.S)(v,o,v,l),p(e,t,d)){case N.DISCARD:return!1;case N.KEEP:return!0}}return"intersects"!==i.type}const V=(0,w.Ue)()},43812:(e,t,n)=>{n.d(t,{u:()=>g});var i=n(27366),r=n(7138),s=n(10064),o=n(92026),l=n(49861),a=(n(93169),n(32718),n(84936),n(69912)),u=n(53866),c=n(28970),d=n(51776),p=n(52410),f=n(49818),y=n(21149);const h=d.q;let g=class extends r.Z{get spatialReference(){return this.layerView.view.spatialReference}get layer(){return this.layerView.i3slayer}get defaultQueryJSON(){return new y.Z({outSpatialReference:this.spatialReference}).toJSON()}get _dataQueryEngine(){return this._ensureDataQueryEngine()}constructor(e){super(e)}initialize(){this.addHandles(this.layerView.on("visible-geometry-changed",(()=>this.spatialIndex.events.emit("changed"))))}destroy(){this._dataQueryEngineInstance=(0,o.SC)(this._dataQueryEngineInstance),this._set("layerView",null)}async executeQueryForCount(e,t){return this._dataQueryEngine.executeQueryForCount(this._ensureQueryJSON(e),t)}async executeQueryForExtent(e,t){const{count:n,extent:i}=await this._dataQueryEngine.executeQueryForExtent(this._ensureQueryJSON(e),t);return{count:n,extent:u.Z.fromJSON(i)}}async executeQueryForIds(e,t){return this._dataQueryEngine.executeQueryForIds(this._ensureQueryJSON(e),t)}async executeQuery(e,t){const n=this._ensureQueryJSON(e);if(n.returnGeometry)throw new s.Z("unsupported-query","returnGeometry is not supported when querying a mesh scene layer view, it is only supported when directly querying a scene layer");if(n.returnCentroid)throw new s.Z("unsupported-query","returnCentroid is not yet supported for mesh scene layer queries");const i=await this._dataQueryEngine.executeQuery(n,t),r=f.Z.fromJSON(i);return r.features.forEach((e=>e.geometry=null)),r}_ensureQueryJSON(e){return null==e?this.defaultQueryJSON:e.toJSON()}_ensureDataQueryEngine(){var e;if(this._dataQueryEngineInstance)return this._dataQueryEngineInstance;const t=this.layer.objectIdField||c.d,n=(null===(e=this.layer.fieldsIndex)||void 0===e?void 0:e.toJSON())||new p.Z([]),i=this.layerView.view.resourceController.scheduler,r=this.spatialReference.toJSON(),s=this.priority,o=this.spatialIndex;return this._dataQueryEngineInstance=new h({hasZ:!0,hasM:!1,geometryType:"esriGeometryPolygon",fieldsIndex:n,timeInfo:null,spatialReference:r,objectIdField:t,featureStore:o,scheduler:i,priority:s}),this._dataQueryEngineInstance}};(0,i._)([(0,l.Cb)({constructOnly:!0})],g.prototype,"layerView",void 0),(0,i._)([(0,l.Cb)({constructOnly:!0})],g.prototype,"priority",void 0),(0,i._)([(0,l.Cb)({constructOnly:!0})],g.prototype,"spatialIndex",void 0),(0,i._)([(0,l.Cb)()],g.prototype,"spatialReference",null),(0,i._)([(0,l.Cb)()],g.prototype,"layer",null),(0,i._)([(0,l.Cb)()],g.prototype,"defaultQueryJSON",null),g=(0,i._)([(0,a.j)("esri.views.3d.layers.i3s.I3SQueryEngine")],g)},51246:(e,t,n)=>{n.d(t,{u:()=>l});var i=n(41414),r=n(85403),s=n(80457),o=n(44011);class l{constructor(e){this._objectIdField=e.objectIdField,this._getFeatureExtent=e.getFeatureExtent}getObjectId(e){return e.id}getAttributes(e){var t;const{meta:n,index:i}=e,r={};this._objectIdField&&(r[this._objectIdField]=e.id);const s=null===(t=n.attributeInfo)||void 0===t?void 0:t.attributeData;if(null!=s)for(const l of Object.keys(s))r[l]=(0,o.Jx)(s[l],i);return r}getAttribute(e,t){var n;if(t===this._objectIdField)return e.id;const{meta:i,index:r}=e,s=null===(n=i.attributeInfo)||void 0===n?void 0:n.attributeData;return null!=s?(0,o.Jx)(s[t],r):null}getGeometry(e){if(e.geometry)return e.geometry;const[t,n,i,r,o]=this._getFeatureExtent(e,a);return new s.Z([5],[t,n,i,r,n,i,r,o,i,t,o,i,t,n,i])}getCentroid(e,t){if(e.geometry)return(0,r.Y)(new s.Z,e.geometry,t.hasZ,t.hasM);const[n,i,o,l,u,c]=this._getFeatureExtent(e,a);return new s.Z([0],[(n+l)/2,(i+u)/2,(o+c)/2])}cloneWithGeometry(e,t){const{id:n,index:i,meta:r}=e;return{id:n,index:i,meta:r,geometry:t}}}const a=(0,i.Ue)()},73552:(e,t,n)=>{n.d(t,{I:()=>y});var i=n(27366),r=n(7138),s=n(91505),o=n(49861),l=(n(93169),n(32718),n(84936),n(69912)),a=n(51066),u=n(41414),c=n(65156),d=n(83479),p=n(42757);const f=(0,u.Ue)();let y=class extends r.Z{constructor(e){super(e),this.events=new s.Z}forEach(e){this.forAllFeatures((t=>(e(t),p.Ku.CONTINUE)))}forEachBounds(e,t){const n=this.getFeatureExtent;for(const i of e)t(n(i,f))}forEachInBounds(e,t){this.forAllFeatures((n=>{const i=this.getFeatureExtent(n,g);return(0,c.kK)(e,(0,u.y8)(i,m))&&t(n),p.Ku.CONTINUE}),(t=>{if((0,a.s)(t.node.serviceMbsInIndexSR,this.sourceSpatialReference,h,this.viewSpatialReference),h[0]>=e[0]&&h[2]<=e[2]&&h[1]>=e[1]&&h[3]<=e[3])return p.Ku.CONTINUE;const n=Math.max(e[0],Math.min(h[0],e[2])),i=Math.max(e[1],Math.min(h[1],e[3])),r=h[0]-n,s=h[1]-i;return r*r+s*s<=h[3]*h[3]?p.Ku.CONTINUE:p.Ku.SKIP}))}};(0,i._)([(0,o.Cb)({constructOnly:!0})],y.prototype,"featureAdapter",void 0),(0,i._)([(0,o.Cb)({constructOnly:!0})],y.prototype,"forAllFeatures",void 0),(0,i._)([(0,o.Cb)({constructOnly:!0})],y.prototype,"getFeatureExtent",void 0),(0,i._)([(0,o.Cb)({constructOnly:!0})],y.prototype,"sourceSpatialReference",void 0),(0,i._)([(0,o.Cb)({constructOnly:!0})],y.prototype,"viewSpatialReference",void 0),y=(0,i._)([(0,l.j)("esri.views.3d.layers.i3s.I3SQueryFeatureStore")],y);const h=(0,d.f)(0,0,0,0),g=(0,u.Ue)(),m=(0,c.Ue)()},1247:(e,t,n)=>{n.d(t,{l:()=>u});var i=n(27366),r=n(32718),s=n(49861),o=(n(93169),n(84936),n(69912)),l=n(89434),a=n(44011);const u=e=>{let t=class extends e{constructor(){super(...arguments),this._definitionExpressionErrors=0,this._maxDefinitionExpressionErrors=20,this.logError=e=>{this._definitionExpressionErrors<this._maxDefinitionExpressionErrors&&r.Z.getLogger(this).error("Error while evaluating definitionExpression: "+e),this._definitionExpressionErrors++,this._definitionExpressionErrors===this._maxDefinitionExpressionErrors&&r.Z.getLogger(this).error("Further errors are ignored")}}get parsedDefinitionExpression(){var e;if(null===(e=this.i3slayer)||void 0===e||!e.definitionExpression)return null;try{const e=l.WhereClause.create(this.i3slayer.definitionExpression,{fieldsIndex:this.i3slayer.fieldsIndex});if(!e.isStandardized)return r.Z.getLogger(this).error("definitionExpression is using non standard function"),null;const t=[],n=e.fieldNames;return(0,a.e8)(n,this.i3slayer.fields,{missingFields:t}),t.length>0?(r.Z.getLogger(this).error("definitionExpression references unknown fields: ".concat(t.join(", "))),null):(this._definitionExpressionErrors=0,e)}catch(t){return r.Z.getLogger(this).error("Failed to parse definitionExpression: "+t),null}}get definitionExpressionFields(){return this.parsedDefinitionExpression?this.parsedDefinitionExpression.fieldNames:[]}_evaluateClause(e,t){try{return e.testFeature(t)}catch(n){return this.logError(n),!1}}_addDefinitionExpressionToQuery(e){if(!this.parsedDefinitionExpression)return e;const t=this.i3slayer.definitionExpression,n=e.clone();return n.where?n.where="(".concat(t,") AND (").concat(n.where,")"):n.where=t,n}};return(0,i._)([(0,s.Cb)({readOnly:!0})],t.prototype,"parsedDefinitionExpression",null),(0,i._)([(0,s.Cb)({readOnly:!0})],t.prototype,"definitionExpressionFields",null),t=(0,i._)([(0,o.j)("esri.views.3d.layers.support.DefinitionExpressionSceneLayerView")],t),t}},77057:(e,t,n)=>{n.d(t,{q:()=>c});var i=n(27366),r=n(49861),s=(n(93169),n(32718),n(84936),n(69912)),o=n(20311),l=n(18661),a=n(50863),u=n(44011);const c=e=>{let t=class extends e{get timeExtent(){var e;return(0,a.h)(this.i3slayer,null===(e=this.view)||void 0===e?void 0:e.timeExtent,this._get("timeExtent"))}get mergedFilter(){var e,t,n;const{filter:i,timeExtent:r}=this;if(null==r)return i;const s=null!==(e=null===i||void 0===i?void 0:i.clone())&&void 0!==e?e:new l.Z;return null!=r&&(s.timeExtent=null!==(t=null===(n=s.timeExtent)||void 0===n?void 0:n.intersection(r))&&void 0!==t?t:r),s}getTimeFilterDependencies(){const{timeInfo:e}=this.i3slayer;if(null==e)return[];const{startField:t,endField:n}=e;return[t,n]}addTimeFilter(e,t){if(null==t)return;const{timeInfo:n}=this.i3slayer;if(null==n)return;const{startField:i,endField:r,useTime:s}=n;if(!s||null==i&&null==r)return;const l=n.toJSON(),a=t.toJSON();e.push(((e,t)=>function(e,t,n,i){var r;const s=null===(r=t.attributeInfo)||void 0===r?void 0:r.attributeData;if(null==s)return;const{startTimeField:l,endTimeField:a}=n;if(null!=l&&null==s[l]||null!=a&&null==s[a])return;const c=(0,o.y)(n,i,new d(s));if(null==c)return;const{featureIds:p}=t;(0,u.hv)(e,p,c)}(e,t,l,a)))}};return(0,i._)([(0,r.Cb)({readOnly:!0})],t.prototype,"timeExtent",null),(0,i._)([(0,r.Cb)()],t.prototype,"mergedFilter",null),t=(0,i._)([(0,s.j)("esri.views.3d.layers.support.TemporalSceneLayerView")],t),t};class d{constructor(e){this.attributeData=e}getAttribute(e,t){return(0,u.Jx)(this.attributeData[t],e)}getAttributeAsTimestamp(e,t){const n=this.getAttribute(e,t);return"string"==typeof n?new Date(n).getTime():"number"==typeof n||null==n?n:null}}},3276:(e,t,n)=>{n.d(t,{s:()=>s});var i=n(49901);class r extends i.G{constructor(e,t){super(e,t,"webmap")}}function s(e){return null!=e&&"object"==typeof e&&"declaredClass"in e&&"esri.WebMap"===e.declaredClass}new r(2,32)}}]);
//# sourceMappingURL=4495.0c744868.chunk.js.map